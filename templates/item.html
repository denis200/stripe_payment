{% extends 'index.html' %}

{%block content%}

    <h2>{{object.name}}</h2>
    <p>{{object.description}}</p>
    <p>{{object.price}}</p>
    
    <button id="buy-button">Buy</button>
    <script src="https://js.stripe.com/v3/"></script>

    <script type="text/javascript">
        var stripe = Stripe('pk_test_51L0NrkKpACydnrXjX9X1VB0Eq7Mkm6Y9fqTAGep34MLisQdPk0z7Lsf36NIMRIt0VmtXCGwRYIauDx0keZ4Lsth000f57SMoca');
        var buyButton = document.getElementById('buy-button');
        buyButton.addEventListener('click', function() {
          // Create a new Checkout Session using the server-side endpoint 
          // Redirect to Stripe Session Checkout
          
          fetch('http://127.0.0.1:8000/buy/1', {method: 'GET'})
          .then(response =>{ return response.json()})
          .then(res => stripe.redirectToCheckout({ sessionId: res.session_id }))
        });
      </script>
    
    

{%endblock%}

